#!/usr/bin/env bash
set -e

clojure_jars=("$(brew --prefix clojure)"/clojure-*.jar)
clojure_jar="${clojure_jars[0]}"

if [[ ! -f $clojure_jar ]]; then
    echo "clojure jar not found: $clojure_jar"
    exit 1
fi

classpath="${CLASSPATH}:${clojure_jar}:${PWD}"
breakchars="(){}[],^%$#@\"\";:''|\\"

if [[ "$#" -eq 0 ]]; then
    exec rlwrap --remember -c -b "$breakchars" -f "${HOME}/.clj_completions" java -cp "$classpath" clojure.main
else
    exec java -cp "$classpath" clojure.main "$@"
fi
